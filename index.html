<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>14ì§€êµ¬ ì•¼ì¿ ë¥´íŠ¸ ë°°ë‹¬ ì²´í¬ë¦¬ìŠ¤íŠ¸</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Noto Sans KR', sans-serif;
        }
        body {
            max-width: 100%;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 10px;
        }
        header {
            background-color: #2D68C4;
            color: white;
            padding: 15px;
            text-align: center;
            border-radius: 8px 8px 0 0;
            margin-bottom: 0;
        }
        .tabs {
            display: flex;
            background-color: #f0f0f0;
            border-bottom: 1px solid #ddd;
            overflow-x: auto;
        }
        .tab {
            padding: 10px 15px;
            cursor: pointer;
            flex: 1;
            text-align: center;
            white-space: nowrap;
        }
        .tab.active {
            background-color: #fff;
            border-bottom: 3px solid #2D68C4;
            font-weight: bold;
        }
        .content {
            background-color: white;
            padding: 15px;
            border-radius: 0 0 8px 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        .day-content {
            display: none;
        }
        .day-content.active {
            display: block;
        }
        .customer {
            border-bottom: 1px solid #eee;
            padding: 10px 0;
            display: flex;
            align-items: center;
        }
        .customer-info {
            flex: 1;
        }
        .customer-name {
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .customer-address {
            font-size: 0.9em;
            color: #666;
        }
        .customer-note {
            font-size: 0.8em;
            color: #ff6b6b;
            margin-top: 2px;
        }
        .customer-products {
            font-size: 0.85em;
            color: #2D68C4;
            position: relative;
            padding-right: 60px;
        }
        .product-actions {
            position: absolute;
            right: 0;
            top: 0;
            display: flex;
        }
        .edit-product-btn, .delete-product-btn {
            border: none;
            background: none;
            color: #2D68C4;
            cursor: pointer;
            padding: 2px 5px;
            font-size: 0.9em;
        }
        .delete-product-btn {
            color: #f44336;
        }
        input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 10px;
        }
        .new-customer-btn {
            background-color: #2D68C4;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            margin-top: 15px;
            cursor: pointer;
            width: 100%;
        }
        .add-product-btn {
            background-color: #4CAF50;
            color: white;
            border: none;
            padding: 6px 10px;
            border-radius: 4px;
            margin-top: 5px;
            cursor: pointer;
            font-size: 0.8em;
        }
        .customer-form, .product-form {
            margin-top: 15px;
            padding: 15px;
            background-color: #f9f9f9;
            border-radius: 5px;
            display: none;
        }
        .form-group {
            margin-bottom: 10px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .form-group input, .form-group textarea, .form-group select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        .form-actions {
            margin-top: 15px;
            display: flex;
            justify-content: space-between;
        }
        .form-actions button {
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
        }
        .save-btn {
            background-color: #2D68C4;
            color: white;
            border: none;
        }
        .cancel-btn {
            background-color: #f0f0f0;
            border: 1px solid #ddd;
        }
        .notes-section {
            margin-top: 20px;
            background-color: #fffde7;
            padding: 15px;
            border-radius: 5px;
        }
        .notes-title {
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .notes-content {
            min-height: 60px;
            background-color: white;
            border: 1px solid #eee;
            padding: 10px;
            border-radius: 4px;
        }
        #editNotes {
            background-color: transparent;
            border: none;
            color: #2D68C4;
            cursor: pointer;
            font-size: 0.9em;
        }
        .completed {
            text-decoration: line-through;
            color: #999;
        }
        .date-display {
            text-align: center;
            background-color: #f0f0f0;
            padding: 8px;
            font-size: 0.9em;
            border-radius: 4px;
            margin-bottom: 15px;
        }
        .search-bar {
            display: flex;
            margin-bottom: 15px;
        }
        .search-input {
            flex: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px 0 0 4px;
        }
        .search-btn {
            background-color: #2D68C4;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 0 4px 4px 0;
            cursor: pointer;
        }
        .clear-btn {
            background-color: #f44336;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            margin-left: 10px;
            cursor: pointer;
        }
        .customer-count {
            text-align: right;
            margin-bottom: 10px;
            font-size: 0.85em;
            color: #666;
        }
        .bulk-actions {
            display: flex;
            margin-bottom: 15px;
            gap: 10px;
        }
        .bulk-btn {
            flex: 1;
            padding: 8px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85em;
        }
        .check-all-btn {
            background-color: #4CAF50;
            color: white;
        }
        .uncheck-all-btn {
            background-color: #f44336;
            color: white;
        }
        .export-btn {
            background-color: #FF9800;
            color: white;
        }
        .scroll-top {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: rgba(45, 104, 196, 0.7);
            color: white;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            display: none;
        }
        .building-tag {
            display: inline-block;
            padding: 2px 5px;
            font-size: 0.75em;
            border-radius: 3px;
            margin-right: 5px;
            color: white;
        }
        .building-tag.preditt {
            background-color: #E91E63;
        }
        .building-tag.jainomics {
            background-color: #673AB7;
        }
        .building-tag.ramian {
            background-color: #2196F3;
        }
        .building-tag.prugio {
            background-color: #4CAF50;
        }
        .building-tag.other {
            background-color: #795548;
        }
        .filter-section {
            margin-bottom: 15px;
        }
        .filter-btn {
            margin-right: 5px;
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 15px;
            cursor: pointer;
            font-size: 0.8em;
            background-color: white;
        }
        .filter-btn.active {
            background-color: #2D68C4;
            color: white;
            border-color: #2D68C4;
        }
        .customer-actions {
            display: flex;
            align-items: center;
        }
        .edit-customer-btn, .delete-customer-btn {
            border: none;
            background: none;
            cursor: pointer;
            padding: 3px;
            margin-left: 5px;
        }
        .edit-customer-btn {
            color: #2D68C4;
        }
        .delete-customer-btn {
            color: #f44336;
        }
        .data-management {
            margin-top: 15px;
            padding: 15px;
            background-color: #e3f2fd;
            border-radius: 5px;
        }
        .data-management h3 {
            margin-top: 0;
            margin-bottom: 10px;
        }
        .data-buttons {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .data-btn {
            flex: 1;
            padding: 8px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85em;
        }
        .backup-btn {
            background-color: #4CAF50;
            color: white;
        }
        .restore-btn {
            background-color: #2196F3;
            color: white;
        }
        .reset-btn {
            background-color: #f44336;
            color: white;
        }
        #backupData {
            width: 100%;
            height: 100px;
            margin-top: 10px;
            display: none;
        }
        .daily-mode {
            display: flex;
            align-items: center;
            margin-top: 10px;
            margin-bottom: 20px;
        }
        .daily-mode label {
            margin-left: 10px;
            font-weight: bold;
        }
        .daily-mode-switch {
            position: relative;
            display: inline-block;
            width: 50px;
            height: 24px;
        }
        .daily-mode-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        .daily-mode-slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 24px;
        }
        .daily-mode-slider:before {
            position: absolute;
            content: "";
            height: 16px;
            width: 16px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        input:checked + .daily-mode-slider {
            background-color: #2D68C4;
        }
        input:checked + .daily-mode-slider:before {
            transform: translateX(26px);
        }
        .preditt-mode {
            margin-top: 10px;
            padding: 10px;
            background-color: #ffebee;
            border-radius: 5px;
            display: none;
        }
        .preditt-mode h3 {
            margin-top: 0;
            color: #E91E63;
        }
        .reset-preditt-btn {
            background-color: #E91E63;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        .storage-status {
            font-size: 0.8em;
            color: #666;
            text-align: center;
            margin-top: 10px;
        }
        .error-message {
            color: #f44336;
            font-size: 0.8em;
            margin-top: 5px;
            text-align: center;
            display: none;
        }
        .import-section {
            margin-top: 15px;
            padding: 15px;
            background-color: #fff3e0;
            border-radius: 5px;
        }
        .import-section h3 {
            margin-top: 0;
            margin-bottom: 10px;
        }
        .import-option {
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 10px;
        }
        .import-option h4 {
            margin-top: 0;
            margin-bottom: 5px;
            color: #FF9800;
        }
        #csvFileInput {
            margin-top: 10px;
        }
        #csvData {
            width: 100%;
            height: 100px;
            margin-top: 10px;
            display: none;
        }
        .import-btn {
            background-color: #FF9800;
            color: white;
            border: none;
            padding: 8px 15px;
            border-radius: 4px;
            cursor: pointer;
        }
        .customer-note {
    font-size: 0.8em;
    color: #ff6b6b;
    margin-top: 2px;
    white-space: normal;
    word-break: break-all;
    overflow-wrap: break-word;
    max-width: 100%;
}

.customer-products {
    font-size: 0.85em;
    color: #2D68C4;
    position: relative;
    padding-right: 70px;
    min-height: 40px;
}

/* íŒì—… ìŠ¤íƒ€ì¼ ì¶”ê°€ */
.note-popup {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    border: 1px solid #ddd;
    padding: 15px;
    border-radius: 5px;
    z-index: 1000;
    max-width: 80%;
    box-shadow: 0 0 10px rgba(0,0,0,0.2);
}

.note-popup-backdrop {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(0,0,0,0.5);
    z-index: 999;
}
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>14ì§€êµ¬ ì•¼ì¿ ë¥´íŠ¸ ë°°ë‹¬</h1>
        </header>
        
        <div class="daily-mode">
            <label class="daily-mode-switch">
                <input type="checkbox" id="dailyModeToggle" onchange="toggleDailyMode()">
                <span class="daily-mode-slider"></span>
            </label>
            <label for="dailyModeToggle">í”„ë ˆë”§ ì£¼ë¬¸ ëª¨ë“œ</label>
        </div>
        
        <div id="predittMode" class="preditt-mode">
            <h3>í”„ë ˆë”§ ì¸í„°ë„· ì£¼ë¬¸ ëª¨ë“œ</h3>
            <p>ë§¤ì¼ ë³€ê²½ë˜ëŠ” í”„ë ˆë”§ ì£¼ë¬¸ì„ ê´€ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‚´ìš©ì„ ìˆ˜ì •í•˜ê³  ìƒˆë¡œê³ ì¹¨í•´ë„ ë°ì´í„°ê°€ ìœ ì§€ë©ë‹ˆë‹¤.</p>
            <button class="reset-preditt-btn" onclick="resetPredittData()">í”„ë ˆë”§ ë°ì´í„° ì´ˆê¸°í™”</button>
        </div>
        
        <div class="tabs">
            <div class="tab" onclick="showDay('monday')">ì›”ìš”ì¼</div>
            <div class="tab" onclick="showDay('tuesday')">í™”ìš”ì¼</div>
            <div class="tab" onclick="showDay('wednesday')">ìˆ˜ìš”ì¼</div>
            <div class="tab" onclick="showDay('thursday')">ëª©ìš”ì¼</div>
            <div class="tab" onclick="showDay('friday')">ê¸ˆìš”ì¼</div>
        </div>
        
        <div class="content">
            <div class="date-display" id="currentDate">2025ë…„ 5ì›” 11ì¼ ì¼ìš”ì¼</div>
            
            <div id="monday" class="day-content">
                <div class="search-bar">
                    <input type="text" class="search-input" id="mondaySearch" placeholder="í˜¸ìˆ˜ ë˜ëŠ” ì œí’ˆìœ¼ë¡œ ê²€ìƒ‰..." oninput="searchCustomers('monday')">
                    <button class="search-btn" onclick="searchCustomers('monday')">ê²€ìƒ‰</button>
                    <button class="clear-btn" onclick="clearSearch('monday')">ì´ˆê¸°í™”</button>
                </div>
                
                <div class="customer-count" id="mondayCount">ì´ 0ëª…ì˜ ê³ ê°</div>
                
                <div class="filter-section">
                    <button class="filter-btn active" data-building="all" onclick="filterBuilding('monday', 'all')">ì „ì²´</button>
                    <button class="filter-btn" data-building="jainomics" onclick="filterBuilding('monday', 'jainomics')">ìì´</button>
                    <button class="filter-btn" data-building="ramian" onclick="filterBuilding('monday', 'ramian')">ë˜ë¯¸ì•ˆ</button>
                    <button class="filter-btn" data-building="prugio" onclick="filterBuilding('monday', 'prugio')">í‘¸ë¥´ì§€ì˜¤</button>
                    <button class="filter-btn" data-building="other" onclick="filterBuilding('monday', 'other')">ê¸°íƒ€</button>
                </div>
                
                <div class="bulk-actions">
                    <button class="bulk-btn check-all-btn" onclick="checkAll('monday')">ëª¨ë‘ ì²´í¬</button>
                    <button class="bulk-btn uncheck-all-btn" onclick="uncheckAll('monday')">ëª¨ë‘ í•´ì œ</button>
                    <button class="bulk-btn export-btn" onclick="exportData('monday')">ë°ì´í„° ë‚´ë³´ë‚´ê¸°</button>
                </div>
                
                <div id="mondayCustomers"></div>
                
                <button class="new-customer-btn" onclick="showNewCustomerForm('monday')">+ ì‹ ê·œ ê³ ê° ì¶”ê°€</button>
                
                <div class="notes-section">
                    <div class="notes-title">
                        <span>ì›”ìš”ì¼ íŠ¹ì´ì‚¬í•­</span>
                        <button id="editNotes" onclick="editNotes('monday')">ìˆ˜ì •</button>
                    </div>
                    <div class="notes-content" id="mondayNotes" contenteditable="false"></div>
                </div>
            </div>
            
            <div id="tuesday" class="day-content">
                <div class="search-bar">
                    <input type="text" class="search-input" id="tuesdaySearch" placeholder="í˜¸ìˆ˜ ë˜ëŠ” ì œí’ˆìœ¼ë¡œ ê²€ìƒ‰..." oninput="searchCustomers('tuesday')">
                    <button class="search-btn" onclick="searchCustomers('tuesday')">ê²€ìƒ‰</button>
                    <button class="clear-btn" onclick="clearSearch('tuesday')">ì´ˆê¸°í™”</button>
                </div>
                
                <div class="customer-count" id="tuesdayCount">ì´ 0ëª…ì˜ ê³ ê°</div>
                
                <div class="filter-section">
                    <button class="filter-btn active" data-building="all" onclick="filterBuilding('tuesday', 'all')">ì „ì²´</button>
                    <button class="filter-btn" data-building="jainomics" onclick="filterBuilding('tuesday', 'jainomics')">ìì´</button>
                    <button class="filter-btn" data-building="ramian" onclick="filterBuilding('tuesday', 'ramian')">ë˜ë¯¸ì•ˆ</button>
                    <button class="filter-btn" data-building="prugio" onclick="filterBuilding('tuesday', 'prugio')">í‘¸ë¥´ì§€ì˜¤</button>
                    <button class="filter-btn" data-building="other" onclick="filterBuilding('tuesday', 'other')">ê¸°íƒ€</button>
                </div>
                
                <div class="bulk-actions">
                    <button class="bulk-btn check-all-btn" onclick="checkAll('tuesday')">ëª¨ë‘ ì²´í¬</button>
                    <button class="bulk-btn uncheck-all-btn" onclick="uncheckAll('tuesday')">ëª¨ë‘ í•´ì œ</button>
                    <button class="bulk-btn export-btn" onclick="exportData('tuesday')">ë°ì´í„° ë‚´ë³´ë‚´ê¸°</button>
                </div>
                
                <div id="tuesdayCustomers"></div>
                
                <button class="new-customer-btn" onclick="showNewCustomerForm('tuesday')">+ ì‹ ê·œ ê³ ê° ì¶”ê°€</button>
                
                <div class="notes-section">
                    <div class="notes-title">
                        <span>í™”ìš”ì¼ íŠ¹ì´ì‚¬í•­</span>
                        <button id="editNotes" onclick="editNotes('tuesday')">ìˆ˜ì •</button>
                    </div>
                    <div class="notes-content" id="tuesdayNotes" contenteditable="false"></div>
                </div>
            </div>
            
            <div id="wednesday" class="day-content">
                <div class="search-bar">
                    <input type="text" class="search-input" id="wednesdaySearch" placeholder="í˜¸ìˆ˜ ë˜ëŠ” ì œí’ˆìœ¼ë¡œ ê²€ìƒ‰..." oninput="searchCustomers('wednesday')">
                    <button class="search-btn" onclick="searchCustomers('wednesday')">ê²€ìƒ‰</button>
                    <button class="clear-btn" onclick="clearSearch('wednesday')">ì´ˆê¸°í™”</button>
                </div>
                
                <div class="customer-count" id="wednesdayCount">ì´ 0ëª…ì˜ ê³ ê°</div>
                
                <div class="filter-section">
                    <button class="filter-btn active" data-building="all" onclick="filterBuilding('wednesday', 'all')">ì „ì²´</button>
                    <button class="filter-btn" data-building="jainomics" onclick="filterBuilding('wednesday', 'jainomics')">ìì´</button>
                    <button class="filter-btn" data-building="ramian" onclick="filterBuilding('wednesday', 'ramian')">ë˜ë¯¸ì•ˆ</button>
                    <button class="filter-btn" data-building="prugio" onclick="filterBuilding('wednesday', 'prugio')">í‘¸ë¥´ì§€ì˜¤</button>
                    <button class="filter-btn" data-building="other" onclick="filterBuilding('wednesday', 'other')">ê¸°íƒ€</button>
                </div>
                
                <div class="bulk-actions">
                    <button class="bulk-btn check-all-btn" onclick="checkAll('wednesday')">ëª¨ë‘ ì²´í¬</button>
                    <button class="bulk-btn uncheck-all-btn" onclick="uncheckAll('wednesday')">ëª¨ë‘ í•´ì œ</button>
                    <button class="bulk-btn export-btn" onclick="exportData('wednesday')">ë°ì´í„° ë‚´ë³´ë‚´ê¸°</button>
                </div>
                
                <div id="wednesdayCustomers"></div>
                
                <button class="new-customer-btn" onclick="showNewCustomerForm('wednesday')">+ ì‹ ê·œ ê³ ê° ì¶”ê°€</button>
                
                <div class="notes-section">
                    <div class="notes-title">
                        <span>ìˆ˜ìš”ì¼ íŠ¹ì´ì‚¬í•­</span>
                        <button id="editNotes" onclick="editNotes('wednesday')">ìˆ˜ì •</button>
                    </div>
                    <div class="notes-content" id="wednesdayNotes" contenteditable="false"></div>
                </div>
            </div>
            
            <div id="thursday" class="day-content">
                <div class="search-bar">
                    <input type="text" class="search-input" id="thursdaySearch" placeholder="í˜¸ìˆ˜ ë˜ëŠ” ì œí’ˆìœ¼ë¡œ ê²€ìƒ‰..." oninput="searchCustomers('thursday')">
                    <button class="search-btn" onclick="searchCustomers('thursday')">ê²€ìƒ‰</button>
                    <button class="clear-btn" onclick="clearSearch('thursday')">ì´ˆê¸°í™”</button>
                </div>
                
                <div class="customer-count" id="thursdayCount">ì´ 0ëª…ì˜ ê³ ê°</div>
                
                <div class="filter-section">
                    <button class="filter-btn active" data-building="all" onclick="filterBuilding('thursday', 'all')">ì „ì²´</button>
                    <button class="filter-btn" data-building="jainomics" onclick="filterBuilding('thursday', 'jainomics')">ìì´</button>
                    <button class="filter-btn" data-building="ramian" onclick="filterBuilding('thursday', 'ramian')">ë˜ë¯¸ì•ˆ</button>
                    <button class="filter-btn" data-building="prugio" onclick="filterBuilding('thursday', 'prugio')">í‘¸ë¥´ì§€ì˜¤</button>
                    <button class="filter-btn" data-building="other" onclick="filterBuilding('thursday', 'other')">ê¸°íƒ€</button>
                </div>
                
                <div class="bulk-actions">
                    <button class="bulk-btn check-all-btn" onclick="checkAll('thursday')">ëª¨ë‘ ì²´í¬</button>
                    <button class="bulk-btn uncheck-all-btn" onclick="uncheckAll('thursday')">ëª¨ë‘ í•´ì œ</button>
                    <button class="bulk-btn export-btn" onclick="exportData('thursday')">ë°ì´í„° ë‚´ë³´ë‚´ê¸°</button>
                </div>
                
                <div id="thursdayCustomers"></div>
                
                <button class="new-customer-btn" onclick="showNewCustomerForm('thursday')">+ ì‹ ê·œ ê³ ê° ì¶”ê°€</button>
                
                <div class="notes-section">
                    <div class="notes-title">
                        <span>ëª©ìš”ì¼ íŠ¹ì´ì‚¬í•­</span>
                        <button id="editNotes" onclick="editNotes('thursday')">ìˆ˜ì •</button>
                    </div>
                    <div class="notes-content" id="thursdayNotes" contenteditable="false"></div>
                </div>
            </div>
            
            <div id="friday" class="day-content">
                <div class="search-bar">
                    <input type="text" class="search-input" id="fridaySearch" placeholder="í˜¸ìˆ˜ ë˜ëŠ” ì œí’ˆìœ¼ë¡œ ê²€ìƒ‰..." oninput="searchCustomers('friday')">
                    <button class="search-btn" onclick="searchCustomers('friday')">ê²€ìƒ‰</button>
                    <button class="clear-btn" onclick="clearSearch('friday')">ì´ˆê¸°í™”</button>
                </div>
                
                <div class="customer-count" id="fridayCount">ì´ 0ëª…ì˜ ê³ ê°</div>
                
                <div class="filter-section">
                    <button class="filter-btn active" data-building="all" onclick="filterBuilding('friday', 'all')">ì „ì²´</button>
                    <button class="filter-btn" data-building="jainomics" onclick="filterBuilding('friday', 'jainomics')">ìì´</button>
                    <button class="filter-btn" data-building="ramian" onclick="filterBuilding('friday', 'ramian')">ë˜ë¯¸ì•ˆ</button>
                    <button class="filter-btn" data-building="prugio" onclick="filterBuilding('friday', 'prugio')">í‘¸ë¥´ì§€ì˜¤</button>
                    <button class="filter-btn" data-building="other" onclick="filterBuilding('friday', 'other')">ê¸°íƒ€</button>
                </div>
                
                <div class="bulk-actions">
                    <button class="bulk-btn check-all-btn" onclick="checkAll('friday')">ëª¨ë‘ ì²´í¬</button>
                    <button class="bulk-btn uncheck-all-btn" onclick="uncheckAll('friday')">ëª¨ë‘ í•´ì œ</button>
                    <button class="bulk-btn export-btn" onclick="exportData('friday')">ë°ì´í„° ë‚´ë³´ë‚´ê¸°</button>
                </div>
                
                <div id="fridayCustomers"></div>
                
                <button class="new-customer-btn" onclick="showNewCustomerForm('friday')">+ ì‹ ê·œ ê³ ê° ì¶”ê°€</button>
                
                <div class="notes-section">
                    <div class="notes-title">
                        <span>ê¸ˆìš”ì¼ íŠ¹ì´ì‚¬í•­</span>
                        <button id="editNotes" onclick="editNotes('friday')">ìˆ˜ì •</button>
                    </div>
                    <div class="notes-content" id="fridayNotes" contenteditable="false"></div>
                </div>
            </div>
            
            <!-- ê³ ê° ì¶”ê°€/í¸ì§‘ í¼ -->
            <div id="customerForm" class="customer-form">
                <div class="form-group">
                    <label for="customerBuilding">ì•„íŒŒíŠ¸</label>
                    <select id="customerBuilding">
                        <option value="jainomics">ìì´</option>
                        <option value="ramian">ë˜ë¯¸ì•ˆ</option>
                        <option value="prugio">í‘¸ë¥´ì§€ì˜¤</option>
                        <option value="other">ê¸°íƒ€</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="customerAddress">í˜¸ìˆ˜</label>
                    <input type="text" id="customerAddress" placeholder="ì˜ˆ: 613-1203">
                </div>
                <input type="hidden" id="customerIndex" value="">
                <input type="hidden" id="formMode" value="add">
                
                <div id="productList"></div>
                
                <button class="add-product-btn" onclick="showProductForm('add')">+ ì œí’ˆ ì¶”ê°€</button>
                
                <div class="form-actions">
                    <button class="cancel-btn" onclick="hideCustomerForm()">ì·¨ì†Œ</button>
                    <button class="save-btn" onclick="saveCustomer()">ì €ì¥</button>
                </div>
            </div>
            
            <!-- ì œí’ˆ ì¶”ê°€/í¸ì§‘ í¼ -->
            <div id="productForm" class="product-form">
                <div class="form-group">
                    <label for="productName">ì œí’ˆëª…</label>
                    <input type="text" id="productName" placeholder="ì˜ˆ: ìœŒ ë‹¹ë°¸ëŸ°ìŠ¤">
                </div>
                <div class="form-group">
                    <label for="productQuantity">ìˆ˜ëŸ‰</label>
                    <input type="number" id="productQuantity" placeholder="ì˜ˆ: 1" min="1" value="1">
                </div>
                <div class="form-group">
                    <label for="productNote">íŠ¹ì´ì‚¬í•­</label>
                    <input type="text" id="productNote" placeholder="ì˜ˆ: ì†Œë¹„ê¸°í•œ 10ì¼ ì´ìƒ">
                </div>
                <input type="hidden" id="productIndex" value="">
                <input type="hidden" id="productFormMode" value="add">
                
                <div class="form-actions">
                    <button class="cancel-btn" onclick="hideProductForm()">ì·¨ì†Œ</button>
                    <button class="save-btn" onclick="saveProduct()">ì €ì¥</button>
                </div>
            </div>
            
            <!-- ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì„¹ì…˜ -->
            <div class="import-section">
                <h3>ê³ ê° ë°ì´í„° ê°€ì ¸ì˜¤ê¸°</h3>
                
                <div class="import-option">
                    <h4>CSV íŒŒì¼ ê°€ì ¸ì˜¤ê¸°</h4>
                    <p>ìŠ¤í”„ë ˆë“œì‹œíŠ¸ì—ì„œ CSV íŒŒì¼ë¡œ ì €ì¥í•˜ì—¬ ê°€ì ¸ì˜¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    <p>íŒŒì¼ í˜•ì‹: <code>ìš”ì¼,ì•„íŒŒíŠ¸,í˜¸ìˆ˜,ì œí’ˆëª…,ìˆ˜ëŸ‰,íŠ¹ì´ì‚¬í•­</code></p>
                    <input type="file" id="csvFileInput" accept=".csv">
                    <button class="import-btn" onclick="importCSV()">CSV ê°€ì ¸ì˜¤ê¸°</button>
                </div>
                
                <div class="import-option">
                    <h4>ì§ì ‘ ì…ë ¥í•˜ê¸°</h4>
                    <p>ë°ì´í„°ë¥¼ ë³µì‚¬í•˜ì—¬ ë¶™ì—¬ë„£ê¸°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                    <p>í˜•ì‹: <code>ìš”ì¼,ì•„íŒŒíŠ¸,í˜¸ìˆ˜,ì œí’ˆëª…,ìˆ˜ëŸ‰,íŠ¹ì´ì‚¬í•­</code></p>
                    <textarea id="csvData" placeholder="ìš”ì¼,ì•„íŒŒíŠ¸,í˜¸ìˆ˜,ì œí’ˆëª…,ìˆ˜ëŸ‰,íŠ¹ì´ì‚¬í•­&#10;monday,jainomics,102-1303,ìœŒ ë‹¹ë°¸ëŸ°ìŠ¤,1,ì†Œë¹„ê¸°í•œ 10ì¼ ì´ìƒ&#10;monday,ramian,105-602,ì•¼ì¿ ë¥´íŠ¸ ë¼ì´íŠ¸,2,&#10;..."></textarea>
                    <button class="import-btn" onclick="showCsvInput()">ì…ë ¥ì°½ ì—´ê¸°</button>
                    <button class="import-btn" onclick="importCsvText()" style="display:none;" id="importCsvBtn">ë°ì´í„° ê°€ì ¸ì˜¤ê¸°</button>
                </div>
            </div>
            
            <!-- ë°ì´í„° ê´€ë¦¬ ì„¹ì…˜ -->
            <div class="data-management">
                <h3>ë°ì´í„° ê´€ë¦¬</h3>
                <p>ë°°ë‹¬ ë¦¬ìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ë°±ì—…í•˜ê±°ë‚˜ ë³µì›í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
                
                <div class="data-buttons">
                    <button class="data-btn backup-btn" onclick="backupData()">ë°±ì—…</button>
                    <button class="data-btn restore-btn" onclick="showRestoreForm()">ë³µì›</button>
                    <button class="data-btn reset-btn" onclick="resetData()">ì´ˆê¸°í™”</button>
                </div>
                
                <textarea id="backupData" placeholder="ë°±ì—… ë°ì´í„°ë¥¼ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”"></textarea>
                <div class="storage-status" id="storageStatus"></div>
                <div class="error-message" id="errorMessage"></div>
            </div>
        </div>
    </div>
    
    <button class="scroll-top" id="scrollTop" onclick="scrollToTop()">â†‘</button>

    <script>
        // ë°ì´í„° ì €ì¥ì†Œ - localStorage ëŒ€ì‹  ë©”ëª¨ë¦¬ ì‚¬ìš©
        let storageType = 'memory'; // 'memory', 'local', 'session'
        let memoryStorage = {};
        
        // ì „ì—­ ë³€ìˆ˜
        let customersData = {
            monday: [],
            tuesday: [],
            wednesday: [],
            thursday: [],
            friday: []
        };
        
        // í”„ë ˆë”§ ì „ìš© ë°ì´í„° (ë§¤ì¼ ë³€ê²½ë˜ëŠ” ì¸í„°ë„· ì£¼ë¬¸)
        let predittData = {
            monday: [],
            tuesday: [],
            wednesday: [],
            thursday: [],
            friday: []
        };
        
        let notesData = {
            monday: '',
            tuesday: '',
            wednesday: '',
            thursday: '',
            friday: ''
        };
        
        let currentDay = '';
        let checkboxStates = {};
        let currentFilter = {
            monday: 'all',
            tuesday: 'all',
            wednesday: 'all',
            thursday: 'all',
            friday: 'all'
        };
        
        // ì„ì‹œ ì œí’ˆ ëª©ë¡ (ì œí’ˆ ì¶”ê°€/í¸ì§‘ ì‹œ ì‚¬ìš©)
        let tempProducts = [];
        
        // í”„ë ˆë”§ ëª¨ë“œ ìƒíƒœ
        let isPredittMode = false;
        
        // ì €ì¥ì†Œ ì´ˆê¸°í™”
        function initStorage() {
            // Clear any previous error messages
            document.getElementById('errorMessage').style.display = 'none';
            
            try {
                // Try accessing localStorage in a safer way
                if (typeof localStorage !== 'undefined') {
                    localStorage.setItem('test', '1');
                    localStorage.removeItem('test');
                    storageType = 'local';
                    document.getElementById('storageStatus').textContent = 'ë°ì´í„° ì €ì¥ ë°©ì‹: ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ (í•­ìƒ ìœ ì§€)';
                    return;
                }
            } catch (e) {
                console.log('localStorage ì‚¬ìš© ë¶ˆê°€:', e);
            }
            
            try {
                // Try accessing sessionStorage in a safer way
                if (typeof sessionStorage !== 'undefined') {
                    sessionStorage.setItem('test', '1');
                    sessionStorage.removeItem('test');
                    storageType = 'session';
                    document.getElementById('storageStatus').textContent = 'ë°ì´í„° ì €ì¥ ë°©ì‹: ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ (ë¸Œë¼ìš°ì € ë‹«ì„ ë•Œê¹Œì§€ ìœ ì§€)';
                    document.getElementById('errorMessage').textContent = 'ê°œì¸ì •ë³´ ë³´í˜¸ ëª¨ë“œë‚˜ ë³´ì•ˆ ì„¤ì •ìœ¼ë¡œ ì¸í•´ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ì–´ ì„¸ì…˜ ìŠ¤í† ë¦¬ì§€ë¡œ ëŒ€ì²´í•©ë‹ˆë‹¤. ë¸Œë¼ìš°ì €ë¥¼ ë‹«ìœ¼ë©´ ë°ì´í„°ê°€ ì‚¬ë¼ì§‘ë‹ˆë‹¤.';
                    document.getElementById('errorMessage').style.display = 'block';
                    return;
                }
            } catch (e) {
                console.log('sessionStorage ì‚¬ìš© ë¶ˆê°€:', e);
            }
            
            // Fallback to memory storage
            storageType = 'memory';
            document.getElementById('storageStatus').textContent = 'ë°ì´í„° ì €ì¥ ë°©ì‹: ë©”ëª¨ë¦¬ (í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ì‹œ ì‚¬ë¼ì§)';
            document.getElementById('errorMessage').textContent = 'ë¸Œë¼ìš°ì € ë³´ì•ˆ ì„¤ì •ìœ¼ë¡œ ì¸í•´ ë°ì´í„°ë¥¼ ì˜êµ¬ì ìœ¼ë¡œ ì €ì¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ë©´ ë°ì´í„°ê°€ ì‚¬ë¼ì§‘ë‹ˆë‹¤. ë°ì´í„°ë¥¼ ìœ ì§€í•˜ë ¤ë©´ "ë°±ì—…" ê¸°ëŠ¥ì„ ì´ìš©í•˜ì„¸ìš”.';
            document.getElementById('errorMessage').style.display = 'block';
        }
        
        // ë°ì´í„° ì €ì¥
        function setStorageItem(key, value) {
            try {
                const jsonValue = JSON.stringify(value);
                
                if (storageType === 'local') {
                    localStorage.setItem(key, jsonValue);
                } else if (storageType === 'session') {
                    sessionStorage.setItem(key, jsonValue);
                } else {
                    memoryStorage[key] = jsonValue;
                }
                return true;
            } catch (e) {
                console.error('ë°ì´í„° ì €ì¥ ì˜¤ë¥˜:', e);
                document.getElementById('errorMessage').textContent = 'ë°ì´í„° ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + e.message;
                document.getElementById('errorMessage').style.display = 'block';
                return false;
            }
        }
        
        // ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
        function getStorageItem(key, defaultValue) {
            try {
                let jsonValue;
                
                if (storageType === 'local') {
                    jsonValue = localStorage.getItem(key);
                } else if (storageType === 'session') {
                    jsonValue = sessionStorage.getItem(key);
                } else {
                    jsonValue = memoryStorage[key];
                }
                
                return jsonValue ? JSON.parse(jsonValue) : defaultValue;
            } catch (e) {
                console.error('ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì˜¤ë¥˜:', e);
                document.getElementById('errorMessage').textContent = 'ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + e.message;
                document.getElementById('errorMessage').style.display = 'block';
                return defaultValue;
            }
        }
        
        // ë°ì´í„° ì‚­ì œ
        function removeStorageItem(key) {
            try {
                if (storageType === 'local') {
                    localStorage.removeItem(key);
                } else if (storageType === 'session') {
                    sessionStorage.removeItem(key);
                } else {
                    delete memoryStorage[key];
                }
                return true;
            } catch (e) {
                console.error('ë°ì´í„° ì‚­ì œ ì˜¤ë¥˜:', e);
                return false;
            }
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
        window.onload = function() {
            // ì €ì¥ì†Œ ì´ˆê¸°í™”
            initStorage();
            
            updateCurrentDate();
            loadFromStorage();
            
            // í”„ë ˆë”§ ëª¨ë“œ ìƒíƒœ í™•ì¸
            isPredittMode = getStorageItem('isPredittMode', false);
            document.getElementById('dailyModeToggle').checked = isPredittMode;
            toggleDailyMode();
            
            // ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            window.addEventListener('scroll', function() {
                if (window.pageYOffset > 300) {
                    document.getElementById('scrollTop').style.display = 'flex';
                } else {
                    document.getElementById('scrollTop').style.display = 'none';
                }
            });
            
            // CSV íŒŒì¼ ì…ë ¥ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
            document.getElementById('csvFileInput').addEventListener('change', handleFileSelect);
        };
        
        // í”„ë ˆë”§ ëª¨ë“œ í† ê¸€
        function toggleDailyMode() {
            isPredittMode = document.getElementById('dailyModeToggle').checked;
            
            if (isPredittMode) {
                document.getElementById('predittMode').style.display = 'block';
                
                // Add preditt option to building select if not present
                const buildingSelect = document.getElementById('customerBuilding');
                if (!Array.from(buildingSelect.options).some(opt => opt.value === 'preditt')) {
                    const predittOption = document.createElement('option');
                    predittOption.value = 'preditt';
                    predittOption.textContent = 'í”„ë ˆë”§';
                    buildingSelect.insertBefore(predittOption, buildingSelect.firstChild);
                }
                
                // Add Preditt filter buttons
                const filterSections = document.querySelectorAll('.filter-section');
                filterSections.forEach(section => {
                    if (!section.querySelector('[data-building="preditt"]')) {
                        const allButton = section.querySelector('[data-building="all"]');
                        const predittButton = document.createElement('button');
                        predittButton.className = 'filter-btn';
                        predittButton.setAttribute('data-building', 'preditt');
                        predittButton.textContent = 'í”„ë ˆë”§';
                        predittButton.onclick = function() {
                            const day = section.closest('.day-content').id;
                            filterBuilding(day, 'preditt');
                        };
                        section.insertBefore(predittButton, allButton.nextSibling);
                    } else {
                        section.querySelector('[data-building="preditt"]').style.display = 'inline-block';
                    }
                });
            } else {
                document.getElementById('predittMode').style.display = 'none';
                
                // Hide Preditt filter buttons
                const predittButtons = document.querySelectorAll('[data-building="preditt"]');
                predittButtons.forEach(button => {
                    button.style.display = 'none';
                });
            }
            
            setStorageItem('isPredittMode', isPredittMode);
            
            // Current day data re-rendering
            if (currentDay) {
                renderCustomers(currentDay);
            }
        }
        
        // í”„ë ˆë”§ ë°ì´í„° ì´ˆê¸°í™”
        function resetPredittData() {
            if (confirm('í”„ë ˆë”§ ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                predittData = {
                    monday: [],
                    tuesday: [],
                    wednesday: [],
                    thursday: [],
                    friday: []
                };
                
                saveToStorage();
                renderCustomers(currentDay);
                alert('í”„ë ˆë”§ ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // í˜„ì¬ ë‚ ì§œ í‘œì‹œ
        function updateCurrentDate() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
            document.getElementById('currentDate').textContent = now.toLocaleDateString('ko-KR', options);
            
            // í˜„ì¬ ìš”ì¼ì— ë§ëŠ” íƒ­ ìë™ ì„ íƒ
            const days = ['sunday', 'monday', 'tuesday', 'wednesday', 'thursday', 'friday', 'saturday'];
            const today = days[now.getDay()];
            if (today !== 'saturday' && today !== 'sunday') {
                showDay(today);
            } else {
                showDay('monday'); // ì£¼ë§ì¸ ê²½ìš° ì›”ìš”ì¼ íƒ­ ì„ íƒ
            }
        }
        
        // ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„° ë¡œë“œ
        function loadFromStorage() {
            const savedCustomersData = getStorageItem('customersData', null);
            if (savedCustomersData) {
                customersData = savedCustomersData;
            }
            
            const savedPredittData = getStorageItem('predittData', null);
            if (savedPredittData) {
                predittData = savedPredittData;
            }
            
            const savedNotesData = getStorageItem('notesData', null);
            if (savedNotesData) {
                notesData = savedNotesData;
            }
            
            const savedCheckboxStates = getStorageItem('checkboxStates', null);
            if (savedCheckboxStates) {
                checkboxStates = savedCheckboxStates;
            }
            
            // ê³ ê° ë°ì´í„° ë Œë”ë§
            renderAllCustomers();
            
            // íŠ¹ì´ì‚¬í•­ ë Œë”ë§
            renderNotes();
            
            // ê³ ê° ìˆ˜ ì—…ë°ì´íŠ¸
            updateCustomerCounts();
        }
        
        // ìŠ¤í† ë¦¬ì§€ì— ë°ì´í„° ì €ì¥
        function saveToStorage() {
            setStorageItem('customersData', customersData);
            setStorageItem('predittData', predittData);
            setStorageItem('notesData', notesData);
            setStorageItem('checkboxStates', checkboxStates);
        }
        
        // ëª¨ë“  ìš”ì¼ì˜ ê³ ê° ë°ì´í„° ë Œë”ë§
        function renderAllCustomers() {
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];
            days.forEach(day => renderCustomers(day));
        }
        
        // ìš”ì¼ë³„ ê³ ê° ë°ì´í„° ë Œë”ë§
        function renderCustomers(day) {
            const container = document.getElementById(`${day}Customers`);
            if (!container) return;
            
            container.innerHTML = '';
            
            // í”„ë ˆë”§ ëª¨ë“œì— ë”°ë¼ ë°ì´í„° ê²°ì •
            let data = isPredittMode ? 
                predittData[day] : 
                customersData[day];
            
            // í•„í„°ë§ëœ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            if (currentFilter[day] !== 'all') {
                data = data.filter(customer => customer.building === currentFilter[day]);
            }
            
            // ì£¼ì†Œ ê¸°ì¤€ìœ¼ë¡œ ì •ë ¬ (ê°™ì€ ì£¼ì†Œë¼ë¦¬ ëª¨ìœ¼ê¸°)
            data.sort((a, b) => a.address.localeCompare(b.address));
            
            // ê³ ê° ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
            data.forEach((customer, index) => {
                // ê±´ë¬¼ íƒœê·¸ í´ë˜ìŠ¤ ê²°ì •
                const buildingClass = getBuildingClass(customer.building);
                
                // ì²´í¬ë°•ìŠ¤ ìƒíƒœ í™•ì¸
                const key = isPredittMode ? 
                    `preditt-${day}-${index}` : 
                    `${day}-${index}`;
                const isChecked = checkboxStates[key] ? 'checked' : '';
                const isCompleted = checkboxStates[key] ? 'completed' : '';
                
                let productsHTML = '';
                customer.products.forEach((product, productIndex) => {
                    productsHTML += `
                        <div class="customer-products">
                            ${product.name} ${product.quantity}ê°œ
                            <div class="product-actions">
                                <button class="edit-product-btn" onclick="editProduct('${day}', ${index}, ${productIndex})">âœ</button>
                                <button class="delete-product-btn" onclick="deleteProduct('${day}', ${index}, ${productIndex})">âœ•</button>
                            </div>
                           ${product.note ? `<div class="customer-note" onclick="showNotePopup('${product.note.replace(/'/g, "\\'")}')"><span style="text-decoration:underline;">${product.note}</span> <small>ğŸ‘†</small></div>` : ''}
                        </div>
                    `;
                });
                
                const customerHTML = `
                    <div class="customer">
                        <input type="checkbox" ${isChecked} onchange="toggleComplete(this, '${day}', ${index})">
                        <div class="customer-info ${isCompleted}">
                            <div class="customer-name">
                                <div>
                                    <span class="building-tag ${buildingClass}">${getBuildingDisplayName(customer.building)}</span>
                                    ${customer.address}
                                </div>
                                <div class="customer-actions">
                                    <button class="edit-customer-btn" onclick="editCustomer('${day}', ${index})">âœ</button>
                                    <button class="delete-customer-btn" onclick="deleteCustomer('${day}', ${index})">âœ•</button>
                                </div>
                            </div>
                            ${productsHTML}
                            <button class="add-product-btn" onclick="addProductToCustomer('${day}', ${index})">+ ì œí’ˆ ì¶”ê°€</button>
                        </div>
                    </div>
                `;
                
                container.innerHTML += customerHTML;
            });
            
            // ê³ ê° ìˆ˜ ì—…ë°ì´íŠ¸
            updateCustomerCounts();
        }
        
        // ê±´ë¬¼ í´ë˜ìŠ¤ ê°€ì ¸ì˜¤ê¸°
        function getBuildingClass(building) {
            switch(building) {
                case 'preditt': return 'preditt';
                case 'jainomics': return 'jainomics';
                case 'ramian': return 'ramian';
                case 'prugio': return 'prugio';
                default: return 'other';
            }
        }
        
        // ê±´ë¬¼ í‘œì‹œ ì´ë¦„ ê°€ì ¸ì˜¤ê¸°
        function getBuildingDisplayName(building) {
            switch(building) {
                case 'preditt': return 'í”„ë ˆë”§';
                case 'jainomics': return 'ìì´';
                case 'ramian': return 'ë˜ë¯¸ì•ˆ';
                case 'prugio': return 'í‘¸ë¥´ì§€ì˜¤';
                default: return 'ê¸°íƒ€';
            }
        }
        
        // ìš”ì¼ë³„ íŠ¹ì´ì‚¬í•­ ë Œë”ë§
        function renderNotes() {
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];
            days.forEach(day => {
                const element = document.getElementById(`${day}Notes`);
                if (element) {
                    element.textContent = notesData[day] || '';
                }
            });
        }
        
        // ê±´ë¬¼ë³„ í•„í„°ë§
        function filterBuilding(day, building) {
            currentFilter[day] = building;
            
            // í•„í„° ë²„íŠ¼ í™œì„±í™” ìƒíƒœ ì—…ë°ì´íŠ¸
            const filterButtons = document.querySelectorAll(`#${day} .filter-btn`);
            filterButtons.forEach(button => {
                if (button.dataset.building === building) {
                    button.classList.add('active');
                } else {
                    button.classList.remove('active');
                }
            });
            
            // ê³ ê° ë°ì´í„° ë‹¤ì‹œ ë Œë”ë§
            renderCustomers(day);
        }
        
        // ìš”ì¼ë³„ ë°ì´í„° í‘œì‹œ
        function showDay(day) {
            // ëª¨ë“  ë‚´ìš© ìˆ¨ê¸°ê¸°
            const contents = document.querySelectorAll('.day-content');
            contents.forEach(content => {
                content.classList.remove('active');
            });
            
            // ëª¨ë“  íƒ­ ë¹„í™œì„±í™”
            const tabs = document.querySelectorAll('.tab');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // ì„ íƒí•œ ìš”ì¼ ë‚´ìš©ê³¼ íƒ­ í™œì„±í™”
            const dayElement = document.getElementById(day);
            if (dayElement) {
                dayElement.classList.add('active');
            }
            
            const tabIndex = getDayIndex(day);
            const tabElement = document.querySelector(`.tab:nth-child(${tabIndex})`);
            if (tabElement) {
                tabElement.classList.add('active');
            }
            
            // í¼ ìˆ¨ê¸°ê¸°
            hideCustomerForm();
            hideProductForm();
            
            currentDay = day;
        }
        
        // ìš”ì¼ ì¸ë±ìŠ¤ ê°€ì ¸ì˜¤ê¸°
        function getDayIndex(day) {
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];
            return days.indexOf(day) + 1;
        }
        
        // ë°°ë‹¬ ì™„ë£Œ ì²´í¬
        function toggleComplete(checkbox, day, index) {
            const customerInfo = checkbox.nextElementSibling;
            const key = isPredittMode ? 
                `preditt-${day}-${index}` : 
                `${day}-${index}`;
            
            if (checkbox.checked) {
                customerInfo.classList.add('completed');
                checkboxStates[key] = true;
            } else {
                customerInfo.classList.remove('completed');
                delete checkboxStates[key];
            }
            
            // ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
            saveToStorage();
        }
        
        // ëª¨ë‘ ì²´í¬í•˜ê¸°
        function checkAll(day) {
            const checkboxes = document.querySelectorAll(`#${day}Customers input[type="checkbox"]`);
            checkboxes.forEach((checkbox, index) => {
                checkbox.checked = true;
                checkbox.nextElementSibling.classList.add('completed');
                
                const key = isPredittMode ? 
                    `preditt-${day}-${index}` : 
                    `${day}-${index}`;
                checkboxStates[key] = true;
            });
            
            // ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
            saveToStorage();
        }
        
        // ëª¨ë‘ ì²´í¬ í•´ì œí•˜ê¸°
        function uncheckAll(day) {
            const checkboxes = document.querySelectorAll(`#${day}Customers input[type="checkbox"]`);
            checkboxes.forEach((checkbox, index) => {
                checkbox.checked = false;
                checkbox.nextElementSibling.classList.remove('completed');
                
                const key = isPredittMode ? 
                    `preditt-${day}-${index}` : 
                    `${day}-${index}`;
                delete checkboxStates[key];
            });
            
            // ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
            saveToStorage();
        }
        
        // ê³ ê° ê²€ìƒ‰
        function searchCustomers(day) {
            const searchTerm = document.getElementById(`${day}Search`).value.toLowerCase();
            
            // í”„ë ˆë”§ ëª¨ë“œì— ë”°ë¼ ë°ì´í„° ê²°ì •
            let data = isPredittMode ? 
                predittData[day] : 
                customersData[day];
            
            // í•„í„°ë§ëœ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            if (currentFilter[day] !== 'all') {
                data = data.filter(customer => customer.building === currentFilter[day]);
            }
            
            // ê²€ìƒ‰ì–´ë¡œ í•„í„°ë§
            if (searchTerm) {
                data = data.filter(customer => 
                    customer.address.toLowerCase().includes(searchTerm) ||
                    customer.products.some(product => 
                        product.name.toLowerCase().includes(searchTerm) ||
                        (product.note && product.note.toLowerCase().includes(searchTerm))
                    )
                );
            }
            
            // ê³ ê° ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
            const container = document.getElementById(`${day}Customers`);
            container.innerHTML = '';
            
            data.forEach((customer, index) => {
                // ê±´ë¬¼ íƒœê·¸ í´ë˜ìŠ¤ ê²°ì •
                const buildingClass = getBuildingClass(customer.building);
                
                // ì²´í¬ë°•ìŠ¤ ìƒíƒœ í™•ì¸
                const key = isPredittMode ? 
                    `preditt-${day}-${index}` : 
                    `${day}-${index}`;
                const isChecked = checkboxStates[key] ? 'checked' : '';
                const isCompleted = checkboxStates[key] ? 'completed' : '';
                
                let productsHTML = '';
                customer.products.forEach((product, productIndex) => {
                    productsHTML += `
                        <div class="customer-products">
                            ${product.name} ${product.quantity}ê°œ
                            <div class="product-actions">
                                <button class="edit-product-btn" onclick="editProduct('${day}', ${index}, ${productIndex})">âœ</button>
                                <button class="delete-product-btn" onclick="deleteProduct('${day}', ${index}, ${productIndex})">âœ•</button>
                            </div>
                            ${product.note ? `<div class="customer-note" onclick="showNotePopup('${product.note.replace(/'/g, "\\'")}')"><span style="text-decoration:underline;">${product.note}</span> <small>ğŸ‘†</small></div>` : ''}
                        </div>
                    `;
                });
                
                const customerHTML = `
                    <div class="customer">
                        <input type="checkbox" ${isChecked} onchange="toggleComplete(this, '${day}', ${index})">
                        <div class="customer-info ${isCompleted}">
                            <div class="customer-name">
                                <div>
                                    <span class="building-tag ${buildingClass}">${getBuildingDisplayName(customer.building)}</span>
                                    ${customer.address}
                                </div>
                                <div class="customer-actions">
                                    <button class="edit-customer-btn" onclick="editCustomer('${day}', ${index})">âœ</button>
                                    <button class="delete-customer-btn" onclick="deleteCustomer('${day}', ${index})">âœ•</button>
                                </div>
                            </div>
                            ${productsHTML}
                            <button class="add-product-btn" onclick="addProductToCustomer('${day}', ${index})">+ ì œí’ˆ ì¶”ê°€</button>
                        </div>
                    </div>
                `;
                
                container.innerHTML += customerHTML;
            });
            
            // ê²€ìƒ‰ ê²°ê³¼ ìˆ˜ ì—…ë°ì´íŠ¸
            document.getElementById(`${day}Count`).textContent = `ê²€ìƒ‰ ê²°ê³¼: ${data.length}ëª…ì˜ ê³ ê°`;
        }
        
        // ê²€ìƒ‰ ì´ˆê¸°í™”
        function clearSearch(day) {
            document.getElementById(`${day}Search`).value = '';
            renderCustomers(day);
        }
        
        // ê³ ê° ìˆ˜ ì—…ë°ì´íŠ¸
        function updateCustomerCounts() {
            const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];
            days.forEach(day => {
                const countElement = document.getElementById(`${day}Count`);
                if (!countElement) return;
                
                // í”„ë ˆë”§ ëª¨ë“œì— ë”°ë¼ ë°ì´í„° ê²°ì •
                let data = isPredittMode ? 
                    predittData[day] : 
                    customersData[day];
                
                // í•„í„°ë§ëœ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                if (currentFilter[day] !== 'all') {
                    data = data.filter(customer => customer.building === currentFilter[day]);
                }
                
                // ì´ ì œí’ˆ ìˆ˜ ê³„ì‚°
                let productCount = 0;
                data.forEach(customer => {
                    productCount += customer.products.length;
                });
                
                countElement.textContent = `ì´ ${data.length}ê°œ í˜¸ìˆ˜, ${productCount}ê°œ ì œí’ˆ`;
            });
        }
        
        // ê³ ê° ì¶”ê°€ í¼ í‘œì‹œ
        function showNewCustomerForm(day) {
            // ì„ì‹œ ì œí’ˆ ëª©ë¡ ì´ˆê¸°í™”
            tempProducts = [];
            
            // í¼ ì´ˆê¸°í™”
            document.getElementById('customerForm').style.display = 'block';
            
            // ê±´ë¬¼ íƒ€ì… ì„¤ì •
            if (isPredittMode) {
                // preditt ì˜µì…˜ì´ ì—†ìœ¼ë©´ ì¶”ê°€
                const buildingSelect = document.getElementById('customerBuilding');
                if (!Array.from(buildingSelect.options).some(opt => opt.value === 'preditt')) {
                    const predittOption = document.createElement('option');
                    predittOption.value = 'preditt';
                    predittOption.textContent = 'í”„ë ˆë”§';
                    buildingSelect.insertBefore(predittOption, buildingSelect.firstChild);
                }
                document.getElementById('customerBuilding').value = 'preditt';
            } else {
                document.getElementById('customerBuilding').value = 'jainomics';
            }
            
            document.getElementById('customerAddress').value = '';
            document.getElementById('customerIndex').value = '';
            document.getElementById('formMode').value = 'add';
            document.getElementById('productList').innerHTML = '';
            
            currentDay = day;
        }
        
        // ê³ ê° ì¶”ê°€/í¸ì§‘ í¼ ìˆ¨ê¸°ê¸°
        function hideCustomerForm() {
            document.getElementById('customerForm').style.display = 'none';
        }
        
        // ê³ ê° ìˆ˜ì •
        function editCustomer(day, index) {
            // í•´ë‹¹ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const data = isPredittMode ? predittData[day] : customersData[day];
            const customer = data[index];
            
            // ì„ì‹œ ì œí’ˆ ëª©ë¡ ì„¤ì •
            tempProducts = [...customer.products];
            
            // í¼ ì´ˆê¸°í™”
            document.getElementById('customerForm').style.display = 'block';
            
            // Preditt ëª¨ë“œì¼ ë•Œ ê±´ë¬¼ ì˜µì…˜ í™•ì¸
            if (isPredittMode) {
                const buildingSelect = document.getElementById('customerBuilding');
                if (!Array.from(buildingSelect.options).some(opt => opt.value === 'preditt')) {
                    const predittOption = document.createElement('option');
                    predittOption.value = 'preditt';
                    predittOption.textContent = 'í”„ë ˆë”§';
                    buildingSelect.insertBefore(predittOption, buildingSelect.firstChild);
                }
            }
            
            document.getElementById('customerBuilding').value = customer.building;
            document.getElementById('customerAddress').value = customer.address;
            document.getElementById('customerIndex').value = index;
            document.getElementById('formMode').value = 'edit';
            
            // ì œí’ˆ ëª©ë¡ í‘œì‹œ
            renderProductList();
            
            currentDay = day;
        }
        
        // ê³ ê° ì‚­ì œ
        function deleteCustomer(day, index) {
            if (confirm('ì´ ê³ ê°ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                // ë°ì´í„°ì—ì„œ ê³ ê° ì œê±°
                if (isPredittMode) {
                    predittData[day].splice(index, 1);
                } else {
                    customersData[day].splice(index, 1);
                }
                
                // ì²´í¬ë°•ìŠ¤ ìƒíƒœ ì—…ë°ì´íŠ¸
                const key = isPredittMode ? 
                    `preditt-${day}-${index}` : 
                    `${day}-${index}`;
                delete checkboxStates[key];
                
                // ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
                saveToStorage();
                
                // ê³ ê° ë°ì´í„° ë‹¤ì‹œ ë Œë”ë§
                renderCustomers(day);
            }
        }
        
        // ì œí’ˆ ëª©ë¡ ë Œë”ë§
        function renderProductList() {
            const productList = document.getElementById('productList');
            productList.innerHTML = '';
            
            tempProducts.forEach((product, index) => {
                const productHTML = `
                    <div style="margin-bottom: 10px; padding: 10px; background-color: #f0f0f0; border-radius: 4px;">
                        <div style="font-weight: bold;">${product.name} ${product.quantity}ê°œ</div>
                        ${product.note ? `<div style="font-size: 0.8em; color: #ff6b6b;">${product.note}</div>` : ''}
                        <div style="margin-top: 5px;">
                            <button style="border: none; background: none; color: #2D68C4; cursor: pointer;" onclick="showProductForm('edit', ${index})">ìˆ˜ì •</button>
                            <button style="border: none; background: none; color: #f44336; cursor: pointer;" onclick="removeProduct(${index})">ì‚­ì œ</button>
                        </div>
                    </div>
                `;
                
                productList.innerHTML += productHTML;
            });
        }
        
        // ì œí’ˆ ì¶”ê°€ í¼ í‘œì‹œ
        function showProductForm(mode, index) {
            document.getElementById('productForm').style.display = 'block';
            
            if (mode === 'add') {
                document.getElementById('productName').value = '';
                document.getElementById('productQuantity').value = '1';
                document.getElementById('productNote').value = '';
                document.getElementById('productIndex').value = '';
                document.getElementById('productFormMode').value = 'add';
            } else if (mode === 'edit') {
                const product = tempProducts[index];
                document.getElementById('productName').value = product.name;
                document.getElementById('productQuantity').value = product.quantity;
                document.getElementById('productNote').value = product.note || '';
                document.getElementById('productIndex').value = index;
                document.getElementById('productFormMode').value = 'edit';
            }
        }
        
        // ì œí’ˆ ì¶”ê°€/ìˆ˜ì • í¼ ìˆ¨ê¸°ê¸°
        function hideProductForm() {
            document.getElementById('productForm').style.display = 'none';
        }
        
        // ì œí’ˆ ì¶”ê°€/ìˆ˜ì •
        function saveProduct() {
            const name = document.getElementById('productName').value.trim();
            const quantity = parseInt(document.getElementById('productQuantity').value) || 1;
            const note = document.getElementById('productNote').value.trim();
            const mode = document.getElementById('productFormMode').value;
            const index = document.getElementById('productIndex').value;
            
            if (name) {
                if (mode === 'add') {
                    // ìƒˆ ì œí’ˆ ì¶”ê°€
                    tempProducts.push({
                        name: name,
                        quantity: quantity,
                        note: note
                    });
                } else if (mode === 'edit') {
                    // ê¸°ì¡´ ì œí’ˆ ìˆ˜ì •
                    tempProducts[index] = {
                        name: name,
                        quantity: quantity,
                        note: note
                    };
                }
                
                // ì œí’ˆ ëª©ë¡ ë‹¤ì‹œ ë Œë”ë§
                renderProductList();
                
                // í¼ ìˆ¨ê¸°ê¸°
                hideProductForm();
            } else {
                alert('ì œí’ˆëª…ì€ í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.');
            }
        }
        
        // ì œí’ˆ ì‚­ì œ
        function removeProduct(index) {
            tempProducts.splice(index, 1);
            renderProductList();
        }
        
        // ê³ ê° ì €ì¥
        function saveCustomer() {
            const building = document.getElementById('customerBuilding').value;
            const address = document.getElementById('customerAddress').value.trim();
            const mode = document.getElementById('formMode').value;
            const index = document.getElementById('customerIndex').value;
            
            if (address && tempProducts.length > 0) {
                if (mode === 'add') {
                    // ìƒˆ ê³ ê° ì¶”ê°€
                    const newCustomer = {
                        building: building,
                        address: address,
                        products: [...tempProducts]
                    };
                    
                    if (isPredittMode) {
                        predittData[currentDay].push(newCustomer);
                    } else {
                        customersData[currentDay].push(newCustomer);
                    }
                } else if (mode === 'edit') {
                    // ê¸°ì¡´ ê³ ê° ìˆ˜ì •
                    const data = isPredittMode ? predittData[currentDay] : customersData[currentDay];
                    data[index] = {
                        building: building,
                        address: address,
                        products: [...tempProducts]
                    };
                }
                
                // ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
                saveToStorage();
                
                // ê³ ê° ë°ì´í„° ë‹¤ì‹œ ë Œë”ë§
                renderCustomers(currentDay);
                
                // í¼ ìˆ¨ê¸°ê¸°
                hideCustomerForm();
            } else {
                alert('í˜¸ìˆ˜ì™€ ìµœì†Œ 1ê°œ ì´ìƒì˜ ì œí’ˆì„ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.');
            }
        }
        
        // ê³ ê°ì— ì œí’ˆ ì¶”ê°€
        function addProductToCustomer(day, index) {
            // í•´ë‹¹ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const data = isPredittMode ? predittData[day] : customersData[day];
            const customer = data[index];
            
            // ì„ì‹œ ì œí’ˆ ëª©ë¡ ì„¤ì •
            tempProducts = [...customer.products];
            
            // ì¸ë±ìŠ¤ ì €ì¥
            document.getElementById('customerIndex').value = index;
            document.getElementById('formMode').value = 'edit';
            document.getElementById('customerBuilding').value = customer.building;
            document.getElementById('customerAddress').value = customer.address;
            
            // ì œí’ˆ ì¶”ê°€ í¼ í‘œì‹œ
            showProductForm('add');
            
            currentDay = day;
        }
        
        // ì œí’ˆ ìˆ˜ì •
        function editProduct(day, customerIndex, productIndex) {
            // í•´ë‹¹ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            const data = isPredittMode ? predittData[day] : customersData[day];
            const customer = data[customerIndex];
            const product = customer.products[productIndex];
            
            // ì„ì‹œ ì œí’ˆ ëª©ë¡ ì„¤ì •
            tempProducts = [...customer.products];
            
            // ì¸ë±ìŠ¤ ì €ì¥
            document.getElementById('customerIndex').value = customerIndex;
            document.getElementById('formMode').value = 'edit';
            document.getElementById('customerBuilding').value = customer.building;
            document.getElementById('customerAddress').value = customer.address;
            
            // ì œí’ˆ í¸ì§‘ í¼ í‘œì‹œ
            showProductForm('edit', productIndex);
            
            currentDay = day;
        }
        
        // ì œí’ˆ ì‚­ì œ
        function deleteProduct(day, customerIndex, productIndex) {
            if (confirm('ì´ ì œí’ˆì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                // í•´ë‹¹ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                const data = isPredittMode ? predittData[day] : customersData[day];
                const customer = data[customerIndex];
                
                // ì œí’ˆ ë°ì´í„°ì—ì„œ ì œê±°
                customer.products.splice(productIndex, 1);
                
                // ì œí’ˆì´ í•˜ë‚˜ë„ ì—†ìœ¼ë©´ ê³ ê°ë„ ì‚­ì œ
                if (customer.products.length === 0) {
                    data.splice(customerIndex, 1);
                }
                
                // ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
                saveToStorage();
                
                // ê³ ê° ë°ì´í„° ë‹¤ì‹œ ë Œë”ë§
                renderCustomers(day);
            }
        }
        
        // íŠ¹ì´ì‚¬í•­ ìˆ˜ì • ëª¨ë“œ ì „í™˜
        function editNotes(day) {
            const notesElement = document.getElementById(`${day}Notes`);
            const isEditable = notesElement.getAttribute('contenteditable') === 'true';
            
            if (isEditable) {
                // í¸ì§‘ ëª¨ë“œ ì¢…ë£Œ
                notesElement.setAttribute('contenteditable', 'false');
                document.querySelector(`#${day} #editNotes`).textContent = 'ìˆ˜ì •';
                
                // ë³€ê²½ëœ ë‚´ìš© ì €ì¥
                notesData[day] = notesElement.textContent;
                
                // ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
                saveToStorage();
            } else {
                // í¸ì§‘ ëª¨ë“œ ì‹œì‘
                notesElement.setAttribute('contenteditable', 'true');
                notesElement.focus();
                document.querySelector(`#${day} #editNotes`).textContent = 'ì €ì¥';
            }
        }
        
        // ë°ì´í„° ë‚´ë³´ë‚´ê¸°
        function exportData(day) {
            // ë‚´ë³´ë‚¼ ë°ì´í„° ì¤€ë¹„
            let exportText = `=== ${getKoreanDayName(day)} ë°°ë‹¬ ë¦¬ìŠ¤íŠ¸ ===\n\n`;
            
            // í”„ë ˆë”§ ëª¨ë“œì— ë”°ë¼ ë°ì´í„° ê²°ì •
            let data = isPredittMode ? 
                predittData[day] : 
                customersData[day];
            
            // í•„í„°ë§ëœ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
            if (currentFilter[day] !== 'all') {
                data = data.filter(customer => customer.building === currentFilter[day]);
            }
            
            // ì •ë ¬
            data.sort((a, b) => a.address.localeCompare(b.address));
            
            // ê³ ê° ë¦¬ìŠ¤íŠ¸ í‘œì‹œ
            data.forEach(customer => {
                exportText += `${getBuildingDisplayName(customer.building)} ${customer.address}\n`;
                
                customer.products.forEach(product => {
                    exportText += `- ${product.name} ${product.quantity}ê°œ\n`;
                    if (product.note) {
                        exportText += `  (${product.note})\n`;
                    }
                });
                
                exportText += '\n';
            });
            
            if (notesData[day]) {
                exportText += 'íŠ¹ì´ì‚¬í•­: ' + notesData[day] + '\n';
            }
            
            // í´ë¦½ë³´ë“œì— ë³µì‚¬ (ëª¨ë°”ì¼ì—ì„œëŠ” ì œí•œì ìœ¼ë¡œ ì‘ë™)
            try {
                navigator.clipboard.writeText(exportText).then(() => {
                    alert('ë°ì´í„°ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                }).catch(err => {
                    // í´ë¦½ë³´ë“œ ì ‘ê·¼ ì‹¤íŒ¨ ì‹œ ëŒ€ì²´ ë°©ë²•
                    fallbackExport(exportText);
                });
            } catch (e) {
                // í´ë¦½ë³´ë“œ APIë¥¼ ì§€ì›í•˜ì§€ ì•ŠëŠ” ë¸Œë¼ìš°ì €
                fallbackExport(exportText);
            }
        }
        
        // í•œê¸€ ìš”ì¼ ì´ë¦„ ê°€ì ¸ì˜¤ê¸°
        function getKoreanDayName(day) {
            switch(day) {
                case 'monday': return 'ì›”ìš”ì¼';
                case 'tuesday': return 'í™”ìš”ì¼';
                case 'wednesday': return 'ìˆ˜ìš”ì¼';
                case 'thursday': return 'ëª©ìš”ì¼';
                case 'friday': return 'ê¸ˆìš”ì¼';
                default: return day;
            }
        }
        
        // ì˜ì–´ ìš”ì¼ ì´ë¦„ ê°€ì ¸ì˜¤ê¸°
        function getEnglishDayName(koreanDay) {
            switch(koreanDay) {
                case 'ì›”ìš”ì¼': return 'monday';
                case 'í™”ìš”ì¼': return 'tuesday';
                case 'ìˆ˜ìš”ì¼': return 'wednesday';
                case 'ëª©ìš”ì¼': return 'thursday';
                case 'ê¸ˆìš”ì¼': return 'friday';
                case 'ì›”': return 'monday';
                case 'í™”': return 'tuesday';
                case 'ìˆ˜': return 'wednesday';
                case 'ëª©': return 'thursday';
                case 'ê¸ˆ': return 'friday';
                default: return koreanDay.toLowerCase();
            }
        }
        
        // ê±´ë¬¼ ì½”ë“œ ê°€ì ¸ì˜¤ê¸°
        function getBuildingCode(buildingName) {
            switch(buildingName.trim().toLowerCase()) {
                case 'í”„ë ˆë”§': return 'preditt';
                case 'ìì´': return 'jainomics';
                case 'ë˜ë¯¸ì•ˆ': return 'ramian';
                case 'í‘¸ë¥´ì§€ì˜¤': return 'prugio';
                default: return 'other';
            }
        }
        
        // ëŒ€ì²´ ë°ì´í„° ë‚´ë³´ë‚´ê¸° ë°©ë²•
        function fallbackExport(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            textarea.style.position = 'fixed';
            document.body.appendChild(textarea);
            textarea.focus();
            textarea.select();
            
            try {
                const successful = document.execCommand('copy');
                if (successful) {
                    alert('ë°ì´í„°ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
                } else {
                    alert('ë°ì´í„°ë¥¼ ë³µì‚¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì•„ë˜ ë‚´ìš©ì„ ì§ì ‘ ë³µì‚¬í•´ì£¼ì„¸ìš”:');
                    alert(text);
                }
            } catch (e) {
                alert('ë°ì´í„°ë¥¼ ë³µì‚¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì•„ë˜ ë‚´ìš©ì„ ì§ì ‘ ë³µì‚¬í•´ì£¼ì„¸ìš”:');
                alert(text);
            }
            
            document.body.removeChild(textarea);
        }
        
        // CSV íŒŒì¼ ì²˜ë¦¬
        function handleFileSelect(evt) {
            const file = evt.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                importCsvData(e.target.result);
            };
            reader.readAsText(file);
        }
        
        // CSV ì…ë ¥ì°½ í‘œì‹œ
        function showCsvInput() {
            const csvData = document.getElementById('csvData');
            csvData.style.display = 'block';
            csvData.focus();
            
            document.getElementById('importCsvBtn').style.display = 'inline-block';
        }
        
        // CSV í…ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
        function importCsvText() {
            const csvData = document.getElementById('csvData').value;
            importCsvData(csvData);
        }
        
        // CSV ë°ì´í„° ì²˜ë¦¬
        function importCsvData(csvText) {
            if (!csvText) {
                alert('ê°€ì ¸ì˜¬ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            const lines = csvText.split(/\r\n|\n|\r/).filter(line => line.trim());
            
            // ì²« ì¤„ì´ í—¤ë”ì¸ì§€ í™•ì¸
            let startIndex = 0;
            if (lines[0].includes('ìš”ì¼') || lines[0].includes('ì•„íŒŒíŠ¸') || lines[0].includes('í˜¸ìˆ˜') || lines[0].includes('ì œí’ˆëª…')) {
                startIndex = 1;
            }
            
            // ìœ íš¨í•œ ë°ì´í„°ì¸ì§€ í™•ì¸
            if (lines.length <= startIndex) {
                alert('ìœ íš¨í•œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // í”„ë ˆë”§ ëª¨ë“œ ì—¬ë¶€ì— ë”°ë¼ ë°ì´í„° ê²°ì •
            const targetData = isPredittMode ? predittData : customersData;
            
            // CSV ë°ì´í„° íŒŒì‹±
            let addedCount = 0;
            for (let i = startIndex; i < lines.length; i++) {
                const line = lines[i].trim();
                if (!line) continue;
                
                // ì‰¼í‘œë¡œ êµ¬ë¶„ëœ ë°ì´í„° íŒŒì‹±
                const parts = line.split(',');
                if (parts.length < 4) continue; // ìµœì†Œ ìš”ì¼, ì•„íŒŒíŠ¸, í˜¸ìˆ˜, ì œí’ˆëª… í•„ìš”
                
                const day = getEnglishDayName(parts[0].trim());
                if (!targetData[day]) continue; // ìœ íš¨í•œ ìš”ì¼ì¸ì§€ í™•ì¸
                
                const building = getBuildingCode(parts[1].trim());
                const address = parts[2].trim();
                const productName = parts[3].trim();
                const productQuantity = parseInt(parts[4]) || 1;
                const productNote = parts.length > 5 ? parts[5].trim() : '';
                
                // ê¸°ì¡´ ê³ ê° ì°¾ê¸°
                let found = false;
                for (let j = 0; j < targetData[day].length; j++) {
                    const customer = targetData[day][j];
                    if (customer.building === building && customer.address === address) {
                        // ê¸°ì¡´ ê³ ê°ì— ì œí’ˆ ì¶”ê°€
                        customer.products.push({
                            name: productName,
                            quantity: productQuantity,
                            note: productNote
                        });
                        found = true;
                        break;
                    }
                }
                
                if (!found) {
                    // ìƒˆ ê³ ê° ì¶”ê°€
                    targetData[day].push({
                        building: building,
                        address: address,
                        products: [{
                            name: productName,
                            quantity: productQuantity,
                            note: productNote
                        }]
                    });
                }
                
                addedCount++;
            }
            
            if (addedCount > 0) {
                // ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
                saveToStorage();
                
                // ë°ì´í„° ë‹¤ì‹œ ë Œë”ë§
                renderAllCustomers();
                
                // CSV ì…ë ¥ì°½ ì´ˆê¸°í™”
                document.getElementById('csvData').value = '';
                document.getElementById('csvData').style.display = 'none';
                document.getElementById('importCsvBtn').style.display = 'none';
                document.getElementById('csvFileInput').value = '';
                
                alert(`${addedCount}ê°œì˜ ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ê°€ì ¸ì™€ì¡ŒìŠµë‹ˆë‹¤!`);
            } else {
                alert('ê°€ì ¸ì˜¬ ìˆ˜ ìˆëŠ” ìœ íš¨í•œ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤. í˜•ì‹ì„ í™•ì¸í•´ì£¼ì„¸ìš”.');
            }
        }
        
        // ë°ì´í„° ë°±ì—…
        function backupData() {
            // ë°±ì—…í•  ë°ì´í„° ì¤€ë¹„
            const backupObject = {
                customersData: customersData,
                predittData: predittData,
                notesData: notesData,
                timestamp: new Date().toISOString()
            };
            
            // JSON ë¬¸ìì—´ë¡œ ë³€í™˜
            const backupString = JSON.stringify(backupObject, null, 2);
            
            // ë°±ì—… ë°ì´í„° í‘œì‹œ
            const backupTextarea = document.getElementById('backupData');
            backupTextarea.value = backupString;
            backupTextarea.style.display = 'block';
            
            // í´ë¦½ë³´ë“œì— ë³µì‚¬
            try {
                navigator.clipboard.writeText(backupString).then(() => {
                    alert('ë°±ì—… ë°ì´í„°ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!\nì´ ë°ì´í„°ë¥¼ ì•ˆì „í•œ ê³³ì— ì €ì¥í•´ë‘ì„¸ìš”.');
                }).catch(err => {
                    alert('ë°±ì—… ë°ì´í„°ë¥¼ ë³µì‚¬í•˜ë ¤ë©´ ì•„ë˜ í…ìŠ¤íŠ¸ë¥¼ ì„ íƒí•˜ê³  ë³µì‚¬í•˜ì„¸ìš”.');
                });
            } catch (e) {
                alert('ë°±ì—… ë°ì´í„°ë¥¼ ë³µì‚¬í•˜ë ¤ë©´ ì•„ë˜ í…ìŠ¤íŠ¸ë¥¼ ì„ íƒí•˜ê³  ë³µì‚¬í•˜ì„¸ìš”.');
            }
        }
        
        // ë³µì› í¼ í‘œì‹œ
        function showRestoreForm() {
            const backupTextarea = document.getElementById('backupData');
            backupTextarea.value = '';
            backupTextarea.style.display = 'block';
            backupTextarea.placeholder = 'ë°±ì—… ë°ì´í„°ë¥¼ ì—¬ê¸°ì— ë¶™ì—¬ë„£ê³  ì—”í„°ë¥¼ ëˆ„ë¥´ì„¸ìš”.';
            
            backupTextarea.focus();
            
            // ì—”í„° í‚¤ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            backupTextarea.onkeydown = function(e) {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    restoreData();
                }
            };
        }
        
        // ë°ì´í„° ë³µì›
        function restoreData() {
            const backupTextarea = document.getElementById('backupData');
            const backupString = backupTextarea.value.trim();
            
            if (!backupString) {
                alert('ë°±ì—… ë°ì´í„°ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            try {
                // JSON íŒŒì‹±
                const backupObject = JSON.parse(backupString);
                
                // ë°ì´í„° ê²€ì¦
                if (!backupObject.customersData || !backupObject.notesData) {
                    throw new Error('ìœ íš¨í•˜ì§€ ì•Šì€ ë°±ì—… ë°ì´í„°ì…ë‹ˆë‹¤.');
                }
                
                // ë°±ì—… í™•ì¸
                if (confirm(`${backupObject.timestamp || 'ì•Œ ìˆ˜ ì—†ëŠ” ë‚ ì§œ'}ì— ë°±ì—…ëœ ë°ì´í„°ë¥¼ ë³µì›í•˜ì‹œê² ìŠµë‹ˆê¹Œ? í˜„ì¬ ë°ì´í„°ëŠ” ëª¨ë‘ ì‚­ì œë©ë‹ˆë‹¤.`)) {
                    // ë°ì´í„° ë³µì›
                    customersData = backupObject.customersData;
                    predittData = backupObject.predittData || {
                        monday: [],
                        tuesday: [],
                        wednesday: [],
                        thursday: [],
                        friday: []
                    };
                    notesData = backupObject.notesData;
                    checkboxStates = {}; // ì²´í¬ë°•ìŠ¤ ìƒíƒœ ì´ˆê¸°í™”
                    
                    // ìŠ¤í† ë¦¬ì§€ì— ì €ì¥
                    saveToStorage();
                    
                    // ë°ì´í„° ë‹¤ì‹œ ë Œë”ë§
                    renderAllCustomers();
                    renderNotes();
                    
                    // ë°±ì—… ë°ì´í„° ìˆ¨ê¸°ê¸°
                    backupTextarea.style.display = 'none';
                    
                    alert('ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë³µì›ë˜ì—ˆìŠµë‹ˆë‹¤!');
                }
            } catch (e) {
                alert('ë°±ì—… ë°ì´í„°ë¥¼ ë³µì›í•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ìœ íš¨í•œ ë°±ì—… ë°ì´í„°ì¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.');
                console.error(e);
            }
        }
        
        // ë°ì´í„° ì´ˆê¸°í™”
        function resetData() {
            if (confirm('ëª¨ë“  ë°ì´í„°ë¥¼ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) {
                customersData = {
                    monday: [],
                    tuesday: [],
                    wednesday: [],
                    thursday: [],
                    friday: []
                };
                
                predittData = {
                    monday: [],
                    tuesday: [],
                    wednesday: [],
                    thursday: [],
                    friday: []
                };
                
                notesData = {
                    monday: '',
                    tuesday: '',
                    wednesday: '',
                    thursday: '',
                    friday: ''
                };
                
                checkboxStates = {};
                
                saveToStorage();
                renderAllCustomers();
                renderNotes();
                
                alert('ëª¨ë“  ë°ì´í„°ê°€ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤.');
            }
        }
        
        // ë§¨ ìœ„ë¡œ ìŠ¤í¬ë¡¤
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }
        // íŠ¹ì´ì‚¬í•­ íŒì—… í‘œì‹œ í•¨ìˆ˜
function showNotePopup(text) {
    const backdrop = document.createElement('div');
    backdrop.className = 'note-popup-backdrop';
    document.body.appendChild(backdrop);
    
    const popup = document.createElement('div');
    popup.className = 'note-popup';
    popup.innerHTML = `
        <h3>íŠ¹ì´ì‚¬í•­ ì „ì²´ ë‚´ìš©</h3>
        <p>${text}</p>
        <button onclick="closeNotePopup()" style="margin-top:10px;padding:5px 10px;background:#2D68C4;color:white;border:none;border-radius:4px;cursor:pointer;">ë‹«ê¸°</button>
    `;
    document.body.appendChild(popup);
}

function closeNotePopup() {
    const backdrop = document.querySelector('.note-popup-backdrop');
    const popup = document.querySelector('.note-popup');
    if (backdrop) backdrop.remove();
    if (popup) popup.remove();
}
    </script>
</body>
</html>
